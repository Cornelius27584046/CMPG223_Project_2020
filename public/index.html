<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <!--
      manifest.json provides metadata used when your web app is installed on a
      user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/
    -->
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <!--
      Notice the use of %PUBLIC_URL% in the tags above.
      It will be replaced with the URL of the `public` folder during the build.
      Only files inside the `public` folder can be referenced from the HTML.

      Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will
      work correctly both with client-side routing and a non-root public URL.
      Learn how to configure a non-root public URL by running `npm run build`.
    -->
    <title>Cornelius Frylinck</title>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <div class="hidden">
      <!--<img id="player" width="220" height="277" src="%PUBLIC_URL%/img/char.png" alt="The Player">-->
    </div>
  </body>
  <script>
    const main = document.getElementById('mainPart');
    const spinner = document.getElementById('spinnerContainer');

    main.classList.remove('hidden');
    spinner.classList.add('hidden');
    spinner.classList.remove('shown');

    intersects = function(x1, x2, w1, w2, y1, y2, h1, h2, dir) {
      var minAx = x1;
      var minAy = y1;
      var maxAx = x1 + w1;
      var maxAy = y1 + 1;
      var minBx = x2;
      var minBy = y2;
      var maxBx = x2 + w2;
      var maxBy = y2 + 2;
      var leftCheck = (minAx < (maxBx + 5));
      var upCheck = (minAy < (maxBy + 5))
      var rightCheck = (maxAx > (minBx - 5));
      var downCheck = (minAy > maxBy)
      if(dir == 'left') return (leftCheck && upCheck);
      if(dir == 'right') return (rightCheck && upCheck);
    }

    aboutPage = function(ctx) {
      ctx.fillStyle = 'black';
      //ctx.drawImage(Img.me, 50, 20, 128, 128);
      let tx = 10;
      let ty = 50;
      ctx.fillText("I am a 23-year old programmer that enjoys:", tx, ty+=10);
      ctx.fillText("- Game Design", tx, ty+=10);
      ctx.fillText("- Web Development.", tx, ty+=10);
      ctx.fillText("- Software Development.", tx, ty+=10);
      ctx.fillText("- Game Development.", tx, ty+=10);
    }

    educationPage = function(ctx) {
      ctx.fillStyle = 'black';
      let tx = 15;
      let ty = 50;
      ctx.fillText("I am finishing my 3-year bachelors degree at the", tx, ty+=10);
      ctx.fillText("  North-West University during November 2020.", tx, ty+=10);
      ctx.fillText("I have obtained a Mastery Badge in Cloud Application ", tx, ty+=10);
      ctx.fillText("  Development from IBM.", tx, ty+=10);
      ctx.fillText("I am LinkedIn Certified in:", tx, ty+=10);
      ctx.fillText(" - Python, C#, Java and C++", tx, ty+=10);
      ctx.fillText("All certifications can be validated by visiting my", tx, ty+=10);
      ctx.fillText("  LinkedIn page by following the link at the bottom", tx, ty+=10);
    }

    function drawCirc(ctx, str, sx, sy, x, y, r, c, c2) {
      return circ = 
      {
          draw: draw = function() {
          ctx.beginPath();
          ctx.lineWidth = 10;
          ctx.fillStyle = c;
          ctx.strokeStyle = c2;
          ctx.arc(x, y, r, 0, Math.PI * 2);
          ctx.fill();
          ctx.fillStyle = 'black';
          ctx.beginPath();
          ctx.lineWidth = 10;
          ctx.fillStyle = c2;
          ctx.strokeStyle = c;
          ctx.arc(x, y, r/2, 0, Math.PI * 2);
          ctx.fill();
          ctx.fillStyle = 'black';
          ctx.fillText(str, sx, sy);
        }
      }
    }

      function Player(w, h) {
        return player = {
          pos: {
            x: w / 2 - 8,
            y: h / 2 - 16
          },
          up: false,
          left: false,
          right: false,
          down: false,
          speed: 1
        }
      }

    var Img = {};
    Img.player = new Image();
    Img.player.src = '%PUBLIC_URL%/img/char_front.png';

    Img.me = new Image();
    Img.me.src = '%PUBLIC_URL%/img/me.jpg';
    Img.me.style.width = Img.me.style.height = 16 + 'px';

    Img.map = {};
    Img.map['grass'] = new Image();
    Img.map['grass'].src = '%PUBLIC_URL%/img/grass.png';

    document.addEventListener('DOMContentLoaded', (event) => {

    	var canvas = document.getElementById("ctx");
    	var ctx = canvas.getContext("2d");
      ctx.font = '10px Arial';

      var details = [];
      
      //const { width, height } = canvas.getBoundingClientRect();
      canvas.style.width = window.innerWidth;
      canvas.style.height = window.innerHeight;
      const width = document.documentElement.clientWidth;
      const height = document.documentElement.clientHeight;
      //console.log(`width: ${width}, height: ${height}`);
      //console.log(`width: ${canvas.width}, height: ${canvas.height}`);
      //canvas.width =

      var player = {};

      player = new Player(canvas.width, canvas.height);

      var about = {};
      var experience = {};
      var education = {};

      details.about = {x: 10, y: 10};
      details.education = {x: canvas.width - 15, y: 10};

      about = drawCirc(ctx, 'Who am I?', 15, 13, details.about.x, details.about.y, 5, '#1635FF', '#3D67FF');
      education = drawCirc(ctx, 'Education & Certifications', canvas.width - 150, 13, details.education.x, details.education.y, 5, '#1635FF', '#3D67FF');

    	document.onkeydown = function(event){
    		if(event.keyCode === 68)	//d
    			player.right = true;
    		else if(event.keyCode === 83)	//s
    			player.down = true;
    		else if(event.keyCode === 65) //a
    			player.left = true;
    		else if(event.keyCode === 87) // w
    			player.up = true;
    	}

    	document.onkeyup = function(event){
    		if(event.keyCode === 68)	//d
    			player.right = false;
    		else if(event.keyCode === 83)	//s
    			player.down = false;
    		else if(event.keyCode === 65) //a
    			player.left = false;
    		else if(event.keyCode === 87) // w
    			player.up = false;
    	}

      setInterval(function(){
        ctx.clearRect(0, 0, ctx.width, ctx.height);
        var x, y, dx, dy;
        x = y = false;
        dx = dy = 0;

        if( player.up || player.down) y = true;
        if( player.left || player.right) x = true;

        if(player.up) {
          var speed = player.speed;
          if(x) speed *= 0.6;
          dy -= speed;
        }
        if(player.left) {
          var speed = player.speed;
          if(y) speed *= 0.6;
          dx -= speed;
        }
        if(player.right) {
          var speed = player.speed;
          if(y) speed *= 0.6;
          dx += speed;
        }
        if(player.down) {
          var speed = player.speed;
          if(x) speed *= 0.5;
          dy += speed;
        }
        player.pos.y += dy;
        player.pos.x += dx;
        player.pos = {
          x: player.pos.x + dx,
          y: player.pos.y += dy
        }

        if(player.pos.x > (canvas.width) - 16) player.pos.x =  (canvas.width - 16);
        if(player.pos.y > (canvas.height) - 32) player.pos.y =  (canvas.height - 32);
        if(player.pos.x < 0) player.pos.x = 0;
        if(player.pos.y < 0) player.pos.y = 0;

        ctx.drawImage(Img.map['grass'], 0, 0, canvas.getBoundingClientRect().width, canvas.getBoundingClientRect().height);
    		//ctx.fillStyle = 'black';
        about.draw();
        education.draw();
        ctx.drawImage(Img.player, Math.floor(player.pos.x), Math.floor(player.pos.y), 16, 32);

        if(intersects(Math.floor(player.pos.x), details.about.x, 5, 16, Math.floor(player.pos.y), details.about.y, 5, 32, 'left') === true)
        {
          aboutPage(ctx);
        }
        if(intersects(Math.floor(player.pos.x), details.education.x, 5, 16, Math.floor(player.pos.y), details.education.y, 5, 32, 'right') === true)
        {
          educationPage(ctx);
        }
          //console.log(intersects(Math.floor(player.pos.x), 5, 16, 10, player.pos.y, 5, 32, 10));
          //console.log(`x1: ${player.pos.x}, 5`)
      },1000/25);
    });
  </script>
</html>
